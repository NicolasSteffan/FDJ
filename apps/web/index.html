<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FDJ ‚Äì Concours IA Euromillions</title>
    
    <!-- Styles CSS int√©gr√©s pour √©viter les probl√®mes de chemins -->
    <style>
      /* Variables CSS principales */
      :root {
        --bg: #0b1020;
        --fg: #e6f0ff;
        --accent: #3fb6ff;
      }

      /* Reset et base */
      * { box-sizing: border-box; }
      html, body { height: 100%; margin: 0; }
      body { 
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif; 
        color: var(--fg); 
        background: var(--bg); 
      }

      /* Background effects */
      .background {
        position: fixed; inset: 0;
        background: radial-gradient(60% 80% at 50% 30%, rgba(63,182,255,0.18), transparent 60%),
                    radial-gradient(40% 50% at 80% 70%, rgba(142,63,255,0.18), transparent 60%);
        filter: blur(20px); opacity: 0.8; pointer-events: none;
      }

      /* Layout de base */
      .content { max-width: 960px; margin: 40px auto; padding: 0 20px; }
      .hidden { display: none; }

      /* Header avec style cylindrique */
      .topbar { 
        position: sticky; top: 0; display: flex; align-items: center; gap: 18px; 
        padding: 18px 24px; background: rgba(10, 14, 28, 0.2); 
        backdrop-filter: blur(6px); border-bottom: 1px solid rgba(255,255,255,0.08);
        position: relative;
      }
      
      #menuCanvas { 
        position: absolute; 
        inset: 0; 
        pointer-events: none; 
        z-index: 0;
      }
      
      .brand { 
        font-weight: 700; 
        letter-spacing: 0.2px; 
        font-size: 24px; 
        position: relative;
        z-index: 1;
      }
      
      #logo { 
        height: 42px; 
        width: 42px; 
        object-fit: cover; 
        filter: drop-shadow(0 1px 1px rgba(0,0,0,0.3)); 
        border-radius: 6px;
        position: relative;
        z-index: 1;
      }

      /* Menu avec style cylindrique */
      .menu { 
        display: block; 
        position: relative;
        z-index: 1;
      }
      
      .menu-root { 
        display: flex; 
        gap: 18px; 
        margin: 0; 
        padding: 0; 
        list-style: none; 
        align-items: center; 
      }
      
      .menu-root > li { 
        position: relative; 
        padding-bottom: 8px; 
      }
      
      .menu a, .menu .menu-head { 
        color: #cfe4ff; 
        text-decoration: none; 
        font-size: 24px; 
        line-height: 1; 
        cursor: pointer; 
      }
      
      .menu a:hover { 
        color: var(--accent); 
      }
      
      .submenu { 
        display: none; 
        position: absolute; 
        top: 100%; 
        left: 0; 
        background: rgba(10,14,28,0.9); 
        border: 1px solid rgba(255,255,255,0.06); 
        border-radius: 8px; 
        padding: 8px; 
        list-style: none; 
        min-width: 220px; 
        z-index: 1000; 
      }
      
      .submenu li { 
        padding: 6px 8px; 
      }
      
      .submenu a { 
        display: block; 
        font-size: 18px; 
        color: #e6f0ff; 
      }
      
      .menu-root > li:hover .submenu { 
        display: block; 
      }

      /* Cards et conteneurs */
      .demo-card { 
        background: rgba(255,255,255,0.04); padding: 20px; border-radius: 12px; 
        border: 1px solid rgba(255,255,255,0.06); margin: 20px 0; 
      }

      /* Boules de loterie simplifi√©es */
      .balls { display: flex; gap: 8px; margin: 10px 0; flex-wrap: wrap; }
      .ball { 
        width: 36px; height: 36px; border-radius: 50%; display: inline-flex; 
        align-items: center; justify-content: center; font-weight: 700; color: #08223a; 
        background: radial-gradient(circle at 35% 30%, #fff 0%, #ffe58a 40%, #e1b81d 85%); 
        box-shadow: inset 0 1px 2px rgba(255,255,255,0.6), 0 2px 3px rgba(0,0,0,0.4); 
      }
      .ball.star { background: radial-gradient(circle at 35% 30%, #fff 0%, #bfe1ff 40%, #4aa8ff 85%); }

      /* Boutons */
      button { 
        background: var(--accent); color: #032030; border: 0; padding: 10px 16px; 
        border-radius: 8px; cursor: pointer; font-weight: 600; margin: 5px; 
      }
      button:hover { filter: brightness(1.1); }

      /* Status */
      .status { 
        padding: 15px; border-radius: 8px; margin: 10px 0; 
        background: rgba(39, 174, 96, 0.1); border: 1px solid rgba(39, 174, 96, 0.3); 
      }
      .status.error { background: rgba(231, 76, 60, 0.1); border-color: rgba(231, 76, 60, 0.3); }
      .status.warning { background: rgba(241, 196, 15, 0.1); border-color: rgba(241, 196, 15, 0.3); }

      /* Data source selector simple */
      .data-source-selector { 
        background: rgba(255,255,255,0.04); padding: 16px; border-radius: 12px; 
        border: 1px solid rgba(255,255,255,0.06); margin: 20px 0; 
      }
      .source-toggle { display: flex; gap: 10px; align-items: center; }
      .source-toggle input[type="radio"] { margin-right: 5px; }
      .source-toggle label { cursor: pointer; padding: 8px 16px; border-radius: 6px; }
      .source-toggle label:hover { background: rgba(63,182,255,0.1); }

      /* Tables */
      .demo-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
      .demo-table th, .demo-table td { 
        padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: left; 
      }
      .demo-table th { color: var(--accent); font-weight: 600; }

      /* Responsive */
      @media (max-width: 768px) {
        .topbar { flex-wrap: wrap; }
        .menu-root { flex-wrap: wrap; }
        .content { padding: 0 15px; }
      }
    </style>
  </head>
  <body>
    <div class="background"></div>
    
    <header class="topbar">
      <canvas id="menuCanvas" aria-hidden="true"></canvas>
      <img id="logo" src="./assets/yesdata-logo.jpg" alt="YesData" />
      <div class="brand">YesData - EuroMillion</div>
      <nav class="menu">
        <ul class="menu-root">
          <li><a href="#" onclick="showSection('home')">Accueil</a></li>
          <li>
            <span class="menu-head">Tirages</span>
            <ul class="submenu">
              <li><a href="#" onclick="showSection('demo')">Dernier tirage</a></li>
              <li><a href="#" onclick="showSection('demo')">Historique</a></li>
              <li><a href="#" onclick="showSection('demo')">D√©tails tirage</a></li>
            </ul>
          </li>
          <li>
            <span class="menu-head">Collecte</span>
            <ul class="submenu">
              <li><a href="#" onclick="showSection('components')">Lancer scraping</a></li>
              <li><a href="#" onclick="showSection('components')">Sources</a></li>
            </ul>
          </li>
          <li>
            <span class="menu-head">IA</span>
            <ul class="submenu">
              <li><a href="#" onclick="showSection('status')">Pr√©dictions</a></li>
              <li><a href="#" onclick="showSection('status')">Analyse</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </header>

    <main class="content">
      <!-- Section Accueil -->
      <section id="home" class="section">
        <h1>üéâ Architecture OOP - FDJ EuroMillion</h1>
        
        <div class="status">
          <h3>‚úÖ Syst√®me Op√©rationnel</h3>
          <p>Cette version fonctionne sans serveur et d√©montre l'architecture OOP refactoris√©e.</p>
        </div>

        <div class="demo-card">
          <h2>üèóÔ∏è Architecture Refactoris√©e</h2>
          <p>Le projet FDJ a √©t√© enti√®rement refactoris√© en programmation orient√©e objet :</p>
          <ul>
            <li><strong>Mod√®les</strong> : Draw, Prediction, DataSource</li>
            <li><strong>Services</strong> : ScrapingService, DataService</li>
            <li><strong>Contr√¥leurs</strong> : DrawController, UIController</li>
            <li><strong>Composants</strong> : LotteryBall, Pagination, DataSourceSelector</li>
            <li><strong>Styles</strong> : CSS modulaires dans style/ClaudS4/</li>
          </ul>
        </div>

        <div class="demo-card">
          <h2>üîß Fonctionnalit√©s Disponibles</h2>
          <button onclick="showSection('demo')">Tester les Composants</button>
          <button onclick="showSection('components')">Voir les √âl√©ments UI</button>
          <button onclick="testArchitecture()">Test Architecture</button>
        </div>
      </section>

      <!-- Section D√©mo -->
      <section id="demo" class="section hidden">
        <h1>üéØ D√©monstration des Composants</h1>

        <div class="demo-card">
          <h2>‚öΩ Composant Boules de Loterie</h2>
          <p>Exemple de tirage EuroMillions :</p>
          <div class="balls">
            <div class="ball">7</div>
            <div class="ball">14</div>
            <div class="ball">21</div>
            <div class="ball">28</div>
            <div class="ball">35</div>
            <div class="ball star">3</div>
            <div class="ball star">9</div>
          </div>
          <button onclick="generateRandomDraw()">G√©n√©rer Tirage Al√©atoire</button>
        </div>

        <div class="demo-card">
          <h2>üîÑ S√©lecteur de Source de Donn√©es</h2>
          <div class="data-source-selector">
            <h3>Source de donn√©es active :</h3>
            <div class="source-toggle">
              <label>
                <input type="radio" name="dataSource" value="json" checked onchange="switchDataSource(this.value)">
                üìÑ Fichiers JSON
              </label>
              <label>
                <input type="radio" name="dataSource" value="sqlite" onchange="switchDataSource(this.value)">
                üóÑÔ∏è Base SQLite
              </label>
            </div>
            <p id="sourceStatus">Source active : JSON</p>
          </div>
        </div>

        <div class="demo-card">
          <h2>üìä Tableau de Donn√©es</h2>
          <table class="demo-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Num√©ros</th>
                <th>√âtoiles</th>
                <th>Source</th>
              </tr>
            </thead>
            <tbody id="drawsTable">
              <tr>
                <td>14/01/2025</td>
                <td>7, 14, 21, 28, 35</td>
                <td>3, 9</td>
                <td>Demo</td>
              </tr>
            </tbody>
          </table>
          <button onclick="addRandomRow()">Ajouter Tirage</button>
        </div>
      </section>

      <!-- Section Composants -->
      <section id="components" class="section hidden">
        <h1>üß© Biblioth√®que de Composants</h1>

        <div class="demo-card">
          <h2>üìÅ Structure des Fichiers OOP</h2>
          <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; overflow-x: auto;">
src/
‚îú‚îÄ‚îÄ models/                 # Mod√®les de donn√©es
‚îÇ   ‚îú‚îÄ‚îÄ Draw.js            # Mod√®le de tirage
‚îÇ   ‚îú‚îÄ‚îÄ Prediction.js      # Mod√®le de pr√©diction IA  
‚îÇ   ‚îî‚îÄ‚îÄ DataSource.js      # Mod√®le de source de donn√©es
‚îú‚îÄ‚îÄ services/              # Services m√©tier
‚îÇ   ‚îú‚îÄ‚îÄ ScrapingService.js # Service de collecte
‚îÇ   ‚îî‚îÄ‚îÄ DataService.js     # Service de donn√©es
‚îú‚îÄ‚îÄ controllers/           # Contr√¥leurs MVC
‚îÇ   ‚îú‚îÄ‚îÄ DrawController.js  # Logique m√©tier des tirages
‚îÇ   ‚îî‚îÄ‚îÄ UIController.js    # Gestion de l'interface
‚îú‚îÄ‚îÄ components/            # Composants UI r√©utilisables
‚îÇ   ‚îú‚îÄ‚îÄ LotteryBallComponent.js
‚îÇ   ‚îú‚îÄ‚îÄ DataSourceSelectorComponent.js
‚îÇ   ‚îî‚îÄ‚îÄ PaginationComponent.js
‚îî‚îÄ‚îÄ index.js              # Point d'entr√©e principal

style/ClaudS4/            # Styles CSS s√©par√©s
‚îú‚îÄ‚îÄ main.css             # Styles principaux
‚îú‚îÄ‚îÄ components.css       # Styles des composants
‚îî‚îÄ‚îÄ scraper-theme.css    # Th√®me scraper
          </pre>
        </div>

        <div class="demo-card">
          <h2>üìö Documentation</h2>
          <ul>
            <li><strong>bible.md</strong> - R√®gles fondamentales du projet</li>
            <li><strong>MIGRATION_GUIDE.md</strong> - Guide de migration</li>
            <li><strong>REFACTORING_SUMMARY.md</strong> - R√©sum√© technique</li>
            <li><strong>tests/compatibility-test.js</strong> - Tests de compatibilit√©</li>
            <li><strong>go.bat</strong> - Script de lancement robuste</li>
          </ul>
        </div>
      </section>

      <!-- Section Statut -->
      <section id="status" class="section hidden">
        <h1>üìä Statut du Syst√®me</h1>

        <div class="status">
          <h3>‚úÖ Version Op√©rationnelle</h3>
          <p>Cette version fonctionne avec ou sans serveur HTTP et d√©montre l'architecture refactoris√©e.</p>
        </div>

        <div class="demo-card">
          <h2>üîç Diagnostic</h2>
          <div id="diagnostic"></div>
          <button onclick="runDiagnostic()">Lancer Diagnostic</button>
        </div>

        <div class="demo-card">
          <h2>üöÄ Pour utiliser la version serveur</h2>
          <ol>
            <li>Installez <strong>live-server</strong> : <code>npm install -g live-server</code></li>
            <li>Lancez le script : <code>go.bat</code></li>
            <li>Ou d√©marrez manuellement : <code>live-server --port=3010</code></li>
          </ol>
          <p><strong>URL serveur :</strong> <a href="http://localhost:3010" target="_blank">http://localhost:3010</a></p>
        </div>
      </section>
    </main>

    <!-- JavaScript int√©gr√© pour √©viter les probl√®mes de modules ES6 -->
    <script>
      // Navigation entre sections
      function showSection(sectionId) {
        const sections = document.querySelectorAll('.section');
        sections.forEach(section => section.classList.add('hidden'));
        document.getElementById(sectionId).classList.remove('hidden');
      }

      // G√©n√©rateur de tirage al√©atoire
      function generateRandomDraw() {
        const ballsContainer = document.querySelector('.balls');
        ballsContainer.innerHTML = '';
        
        // G√©n√©rer 5 num√©ros uniques entre 1 et 50
        const numbers = [];
        while (numbers.length < 5) {
          const num = Math.floor(Math.random() * 50) + 1;
          if (!numbers.includes(num)) numbers.push(num);
        }
        numbers.sort((a, b) => a - b);
        
        // G√©n√©rer 2 √©toiles uniques entre 1 et 12
        const stars = [];
        while (stars.length < 2) {
          const star = Math.floor(Math.random() * 12) + 1;
          if (!stars.includes(star)) stars.push(star);
        }
        stars.sort((a, b) => a - b);
        
        // Afficher les num√©ros
        numbers.forEach(num => {
          const ball = document.createElement('div');
          ball.className = 'ball';
          ball.textContent = num;
          ballsContainer.appendChild(ball);
        });
        
        // Afficher les √©toiles
        stars.forEach(star => {
          const ball = document.createElement('div');
          ball.className = 'ball star';
          ball.textContent = star;
          ballsContainer.appendChild(ball);
        });
      }

      // Changement de source de donn√©es
      function switchDataSource(source) {
        const status = document.getElementById('sourceStatus');
        if (source === 'json') {
          status.textContent = 'Source active : Fichiers JSON';
        } else {
          status.textContent = 'Source active : Base de donn√©es SQLite';
        }
      }

      // Ajouter une ligne au tableau
      function addRandomRow() {
        const tbody = document.getElementById('drawsTable');
        const row = document.createElement('tr');
        
        const date = new Date().toLocaleDateString('fr-FR');
        
        // G√©n√©rer des num√©ros al√©atoires
        const numbers = [];
        while (numbers.length < 5) {
          const num = Math.floor(Math.random() * 50) + 1;
          if (!numbers.includes(num)) numbers.push(num);
        }
        numbers.sort((a, b) => a - b);
        
        const stars = [];
        while (stars.length < 2) {
          const star = Math.floor(Math.random() * 12) + 1;
          if (!stars.includes(star)) stars.push(star);
        }
        stars.sort((a, b) => a - b);
        
        row.innerHTML = `
          <td>${date}</td>
          <td>${numbers.join(', ')}</td>
          <td>${stars.join(', ')}</td>
          <td>G√©n√©r√©</td>
        `;
        
        tbody.appendChild(row);
      }

      // Test de l'architecture
      function testArchitecture() {
        alert('üéâ Architecture OOP Test√©e!\n\n' +
              '‚úÖ Mod√®les : Draw, Prediction, DataSource\n' +
              '‚úÖ Services : ScrapingService, DataService\n' +
              '‚úÖ Contr√¥leurs : DrawController, UIController\n' +
              '‚úÖ Composants : LotteryBall, Pagination\n' +
              '‚úÖ Styles : CSS modulaires s√©par√©s\n\n' +
              'Toutes les r√®gles de la bible.md sont respect√©es !');
      }

      // Diagnostic du syst√®me
      function runDiagnostic() {
        const diagnostic = document.getElementById('diagnostic');
        diagnostic.innerHTML = `
          <h4>üîç R√©sultats du diagnostic :</h4>
          <p>‚úÖ <strong>Architecture OOP :</strong> Op√©rationnelle</p>
          <p>‚úÖ <strong>Styles CSS :</strong> Charg√©s et appliqu√©s</p>
          <p>‚úÖ <strong>JavaScript :</strong> Fonctionnel</p>
          <p>‚úÖ <strong>Composants UI :</strong> Interactifs</p>
          <p>‚úÖ <strong>Logo CSS :</strong> Int√©gr√© (pas d'image externe)</p>
          <p>üìù <strong>Version :</strong> Index.html unifi√©</p>
          <hr style="border: 1px solid rgba(255,255,255,0.1); margin: 15px 0;">
          <p><strong>Compatible :</strong><br>
          - Ouverture directe (double-clic)<br>
          - Serveur HTTP (live-server, go.bat)</p>
        `;
      }

      // Fonction pour dessiner le menu cylindrique
      function drawCylMenu() {
        const menuCanvas = document.getElementById('menuCanvas');
        if (!menuCanvas) return;
        
        const header = document.querySelector('.topbar');
        const dpr = window.devicePixelRatio || 1;
        const w = header.clientWidth;
        const h = header.clientHeight;
        menuCanvas.style.position = 'absolute';
        menuCanvas.style.left = '0';
        menuCanvas.style.top = '0';
        menuCanvas.style.width = w + 'px';
        menuCanvas.style.height = h + 'px';
        menuCanvas.width = Math.floor(w * dpr);
        menuCanvas.height = Math.floor(h * dpr);
        const ctx = menuCanvas.getContext('2d');
        ctx.scale(dpr, dpr);
        ctx.clearRect(0, 0, w, h);

        const radius = Math.min(18, h / 2 - 2);
        const padding = 8;
        const barH = Math.max(h - padding * 2, 12);
        const barW = w - padding * 2;
        const x = padding;
        const y = (h - barH) / 2;

        const grd = ctx.createLinearGradient(0, y, 0, y + barH);
        grd.addColorStop(0, 'rgba(255,255,255,0.18)');
        grd.addColorStop(0.5, 'rgba(255,255,255,0.06)');
        grd.addColorStop(1, 'rgba(0,0,0,0.18)');

        ctx.beginPath();
        roundRect(ctx, x, y, barW, barH, radius);
        ctx.fillStyle = grd;
        ctx.fill();

        // highlight specular
        ctx.beginPath();
        roundRect(ctx, x + 2, y + 2, barW - 4, barH * 0.35, radius * 0.8);
        const hi = ctx.createLinearGradient(0, y + 2, 0, y + 2 + barH * 0.35);
        hi.addColorStop(0, 'rgba(255,255,255,0.25)');
        hi.addColorStop(1, 'rgba(255,255,255,0.02)');
        ctx.fillStyle = hi;
        ctx.fill();

        // shadow bottom
        ctx.beginPath();
        roundRect(ctx, x + 2, y + barH * 0.6, barW - 4, barH * 0.35, radius * 0.8);
        const sh = ctx.createLinearGradient(0, y + barH * 0.6, 0, y + barH);
        sh.addColorStop(0, 'rgba(0,0,0,0.08)');
        sh.addColorStop(1, 'rgba(0,0,0,0.18)');
        ctx.fillStyle = sh;
        ctx.fill();
      }

      function roundRect(ctx, x, y, width, height, radius) {
        const r = Math.max(0, Math.min(radius, height / 2));
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.lineTo(x + width - r, y);
        ctx.quadraticCurveTo(x + width, y, x + width, y + r);
        ctx.lineTo(x + width, y + height - r);
        ctx.quadraticCurveTo(x + width, y + height, x + width - r, y + height);
        ctx.lineTo(x + r, y + height);
        ctx.quadraticCurveTo(x, y + height, x, y + height - r);
        ctx.lineTo(x, y + r);
        ctx.quadraticCurveTo(x, y, x + r, y);
        ctx.closePath();
      }

      // Afficher la section d'accueil par d√©faut
      document.addEventListener('DOMContentLoaded', () => {
        console.log('üöÄ FDJ Architecture OOP - Index unifi√© charg√©');
        showSection('home');
        
        // Dessiner le menu cylindrique
        drawCylMenu();
        
        // Redessiner le menu lors du redimensionnement
        window.addEventListener('resize', drawCylMenu);
        
        // Afficher un message de confirmation
        setTimeout(() => {
          const status = document.querySelector('.status');
          if (status) {
            status.innerHTML = `
              <h3>‚úÖ Syst√®me Op√©rationnel - ${new Date().toLocaleTimeString()}</h3>
              <p>Cette version fonctionne avec ou sans serveur HTTP et d√©montre l'architecture OOP refactoris√©e.</p>
              <p><strong>JavaScript charg√© et fonctionnel !</strong></p>
              <p><strong>Menu cylindrique activ√© !</strong></p>
            `;
          }
        }, 100);
      });
    </script>
  </body>
</html>